数据集介绍：waimai_10k数据集，某外卖平台收集的用户评价，正向4000 条，负向约 8000 条

数据字段：
Label：1表示正向评论，0表示负向评论
Review：评论内容

数据集地址：https://raw.githubusercontent.com/SophonPlus/ChineseNlpCorpus/master/datasets/waimai_10k/waimai_10k.csv

项目结构
sentiment-analysis-system/
├── data/                  # 数据集目录
│   └── waimai_10k.csv      # 原始外卖评论数据集（需手动下载或通过代码自动读取）
├── model/                 # 模型与相关文件保存目录（自动生成）
│   ├── LSTM.keras          # 训练完成的LSTM模型
│   ├── vocab.pkl           # 手动构建的词汇表
│   └── label_encoder.pkl   # 标签编码器（映射Label与情感类别）
├── stopwords.txt          # 中文停用词表（可选，用于过滤无意义词汇）
├── training_log.csv       # 模型训练日志（自动生成，记录loss、accuracy等指标）
├── app.py                 # 核心代码（数据处理、模型训练、Flask服务）
└── README.md              # 项目说明文档

核心功能模块
1. 数据预处理模块
（1）文本清洗
中文保留：通过is_chinese()函数过滤非中文字符，仅保留中文、数字及关键标点（！、？、，、。等）
停用词过滤：通过getStopWords()加载停用词表（如 “的”“了”“在” 等无意义词汇），减少噪声干扰
异常处理：解析数据时捕获异常，跳过无效评论（如空文本、格式错误的数据）
（2）中文分词
使用jieba.lcut()对清洗后的评论文本进行中文分词，示例：输入文本：“很快，好吃味道足，量大” → 分词结果：["很快", "好吃", "味道足", "量大"]
（3）词汇表构建与文本序列化
词汇表构建：基于训练集评论，过滤低频词（默认最小词频≥3），构建大小为max_words=8000的词汇表，保留<PAD>（填充标记）和<UNK>（未登录词标记）
文本序列化：通过texts_to_sequences()将分词后的文本转换为固定长度（max_len=100）的整数序列，长度不足时填充<PAD>，长度超出时截断
（4）数据划分与标签编码
数据划分：使用train_test_split()将数据集按 7:2:1 划分为训练集、验证集、测试集
标签编码：使用LabelEncoder()将 Label（0/1）编码为模型可识别的整数标签（兼容后续分类任务）
2. LSTM 模型模块
（1）模型结构
输入层（Input）→ 嵌入层（Embedding）→ LSTM层 → 全连接层（Dense）→ Dropout层 → 输出层（Dense）
嵌入层（Embedding）：将整数序列映射为 128 维的词向量，捕捉词汇语义信息
LSTM 层：64 个隐藏单元，添加 dropout（0.2）和 recurrent_dropout（0.2）防止过拟合
全连接层：32 个神经元，使用 ReLU 激活函数
输出层：1 个神经元，使用 Sigmoid 激活函数（输出 0~1 的概率值，用于二分类）
（2）模型训练
损失函数：binary_crossentropy（二分类任务常用）
优化器：Adam（自适应学习率，训练稳定）
评估指标：accuracy（准确率）
回调函数：
EarlyStopping：监控验证集 loss，连续 10 轮无下降则停止训练并恢复最优权重
CSVLogger：记录训练日志到training_log.csv
类别权重：通过compute_class_weight()计算类别平衡权重，缓解负向评论数据过多导致的模型偏向性
（3）模型评估
训练完成后，在测试集上计算以下指标评估模型性能：
混淆矩阵（confusion_matrix）：展示真阳性、真阴性、假阳性、假阴性数量
准确率（accuracy）：整体预测正确的样本比例
精确率（precision）：预测为正向 / 负向的样本中实际正确的比例
召回率（recall）：实际为正向 / 负向的样本中被正确预测的比例
F1 分数（f1_score）：精确率与召回率的调和平均数，综合评估模型性能

3. Web 交互模块
（1）界面设计
通过HTML_TEMPLATE定义 Web 界面，包含以下核心元素：
文本输入框：支持用户输入待分析的外卖评论文本
分析按钮：触发情感分析请求
结果展示区：根据分析结果显示不同样式（正向：绿色背景，负向：红色背景，未知：灰色背景）
响应式设计：适配不同屏幕尺寸，优化移动端体验
（2）Flask 路由
首页路由（/）：访问http://127.0.0.1:5000时返回 Web 界面
分析路由（/analyze）：接收 POST 请求，获取用户输入文本，调用预测函数返回情感分析结果
（3）预测流程
用户输入文本并点击 “分析情感” 按钮
前端通过 Fetch API 发送 POST 请求到/analyze接口
后端调用predict_()函数：
检查模型是否存在，不存在则自动训练新模型
对输入文本进行预处理（分词、序列化）
模型预测并将结果映射为 “active”（正向）或 “negative”（负向）
后端返回 JSON 格式结果，前端更新界面展示分析结果

4. 使用说明
运行文件：
predict.py
系统初始化：
首次运行时，因无预训练模型，会自动触发模型训练（约 5~10 分钟，取决于硬件性能）
非首次运行时，会直接加载model/目录下的预训练模型
访问系统：打开浏览器，输入http://127.0.0.1:5000，进入情感分析界面

5. 情感分析操作
在文本输入框中输入外卖评论（示例：“送餐很快，味道很棒，下次还点”“菜凉了，味道很咸，不推荐”）
点击 “分析情感” 按钮，等待 1~2 秒后查看结果：
正向评论：显示 “分析结果: active”，绿色背景
负向评论：显示 “分析结果: negative”，红色背景
异常情况：显示 “请输入文本” 或 “分析出错: xxx”，灰色背景

6. 注意事项：我使用了回调函数，如果超过10轮没有提升，则停止训练，并返回最好的模型，但有可能出现连续10轮效果还没开始变好就停止了，如出现请自行修改轮数。